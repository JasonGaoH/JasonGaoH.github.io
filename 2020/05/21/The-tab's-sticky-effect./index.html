<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="åšæŒè¾“å‡ºï¼ŒåšæŒä¹¦å†™ï¼Œæ‰å¯ä»¥æŒç»­æˆé•¿">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      ä»¿äº¬ä¸œã€æ·˜å®é¦–é¡µï¼Œé€šè¿‡ä¸¤å±‚åµŒå¥—çš„RecyclerViewå®ç°tabçš„å¸é¡¶æ•ˆæœ | JasonGao Thoughts
    
  </title>
 
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" ></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  
  
  

  
  
    <script src="js/local-search.js"></script>
  
<meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="JasonGao Thoughts" type="application/atom+xml">
</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>
  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>JasonGao Thoughts</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/links/" class="item-link">Links</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/abouts/" class="item-link">About</a>
          
        </li>
      
      
      <li class="menu-item menu-item-rss right-list">
    <a href="/atom.xml">
      <i class="fa fa-rss fa-fw"></i>
    </a>
  </li>
      
        <li class="menu-item menu-item-search right-list">
    <a role="button" class="popup-trigger">
        <i class="fa fa-search fa-fw"></i>
    </a>
</li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/links/" class="menu-link">Links</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/abouts/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
    
      <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
            <span class="search-icon">
                <i class="fa fa-search"></i>
            </span>
            <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off"
                    placeholder="Please enter your keyword(s) to search." spellcheck="false"
                    type="search" class="search-input">
            </div>
            <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>
    
  </div>
</header>

    <div id="article-banner">
  <h2>ä»¿äº¬ä¸œã€æ·˜å®é¦–é¡µï¼Œé€šè¿‡ä¸¤å±‚åµŒå¥—çš„RecyclerViewå®ç°tabçš„å¸é¡¶æ•ˆæœ</h2>
  <p class="post-date">2020-05-21</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><blockquote>
<p>æ–‡ç« å·²åŒæ­¥å‘è¡¨äºå¾®ä¿¡å…¬ä¼—å·JasonGaoHï¼Œ<a href="https://mp.weixin.qq.com/s?__biz=MzUyNTE2OTAzMQ==&mid=2247483770&idx=1&sn=38b95c3cff51e216248c0eb860155437&chksm=fa237992cd54f084802be4b0be2b52e4f5052019d51562f65245ca8b0faf3e0d61d296fc0e7d&token=1938879438&lang=zh_CN#rd">ä»¿äº¬ä¸œã€æ·˜å®é¦–é¡µï¼Œé€šè¿‡ä¸¤å±‚åµŒå¥—çš„RecyclerViewå®ç°tabçš„å¸é¡¶æ•ˆæœ</a></p>
</blockquote>
<h3 id="ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç¯‡æ–‡ç« "><a href="#ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç¯‡æ–‡ç« " class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç¯‡æ–‡ç« "></a>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç¯‡æ–‡ç« </h3><p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡æ–‡ç« <a href="https://juejin.im/post/5d233cc86fb9a07ec42b7f57">ä½¿ç”¨CoordinatorLayoutè¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸¤ä¸ªé—®é¢˜ä»¥åŠæµ…æCoordinatorLayoutå·¥ä½œæœºåˆ¶</a>ï¼Œè¿™ç¯‡æ–‡ç« ä¸Šä¸»è¦è®²äº†é€šè¿‡CoordinatorLayoutå®ç°tabå¸é¡¶çš„æ•ˆæœæ—¶é‡åˆ°çš„é—®é¢˜ï¼Œæ•ˆæœè·Ÿäº¬ä¸œã€æ·˜å®é¦–é¡µç±»ä¼¼ï¼Œåªä¸è¿‡å®ç°æ–¹æ³•ä¸åŒè€Œå·²ï¼Œä½†æ˜¯ä½¿ç”¨CoordinatorLayoutæ¥å®ç°æ˜¯ä¼šæœ‰ä¸å°‘ç»†èŠ‚é—®é¢˜æ˜¯å¾ˆéš¾å¤„ç†å¥½çš„ï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
<span id="more"></span>

<p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç®€å•çœ‹ä¸‹äº¬ä¸œé¦–é¡µçš„æ•ˆæœgifï¼Œæ¥çœ‹çœ‹æˆ‘ä»¬åˆ°åº•æ˜¯è¦å®ç°ä»€ä¹ˆæ ·çš„æ•ˆæœï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/jingdong.gif" alt="image"></p>
<p>äº¬ä¸œé¦–é¡µçš„tabç­›é€‰åŒºå°†feedåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸Šé¢æ˜¯å„ç§ä¸åŒitemï¼Œtabçš„ä¸‹åŠéƒ¨åˆ†å¯ä»¥å·¦å³æ¨ªæ»‘ï¼Œå¹¶ä¸”ä¸‹æ‹‰å¯ä»¥åŠ é‡æ›´å¤šï¼Œåªè¦ç½‘ç»œæœ‰æ•°æ®çš„æƒ…å†µä¸‹ç†è®ºä¸Šæ˜¯å¯ä»¥æ— é™ä¸‹æ‹‰çš„ã€‚</p>
<p>å…¶å®ç”¨CoordinatorLayoutæ¥å®ç°tabå¸é¡¶ï¼Œå¦‚æœèƒ½å°†ä¸€äº›ç»†èŠ‚é—®é¢˜å¤„ç†å¥½çš„è¯ï¼Œå…¶å®å¤§è‡´å¯ä»¥å®ç°ç±»ä¼¼äº¬ä¸œé¦–é¡µçš„è¿™ä¸ªæ•ˆæœï¼Œå…·ä½“ç»†èŠ‚é—®é¢˜å¯ä»¥å‚è€ƒæ–‡ç« å¼€å¤´è¯´çš„ä¹‹å‰çš„æ–‡ç« ï¼Œæ–‡ç« é‡Œè®²äº†ä¸‹ä½¿ç”¨CoordinatorLayoutæ¥å®ç°ç±»ä¼¼æ•ˆæœé‡åˆ°çš„åŠ¨ç”»æŠ–åŠ¨é—®é¢˜ä»¥åŠé¡µé¢å›å¼¹é—®é¢˜ä»¥åŠå¯¹åº”çš„è§£å†³æ–¹æ³•ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šä¸é‡‡ç”¨CoordinatorLayoutæ¥å®ç°ï¼Œè½¬è€Œé‡‡ç”¨åµŒå¥—RecyclerViewçš„æ–¹å¼å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹CoordinatorLayoutå®ç°çš„å¤§è‡´å¸ƒå±€ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/CoordinatorLayout.png" alt="image"></p>
<p>ä¸€ä¸ªé—®é¢˜æ˜¯ä»AppBarLayoutæ»‘åŠ¨æ•ˆæœæ˜¯ä¸èƒ½ä¼ é€’åˆ°ä¸‹é¢çš„ViewPageré‡Œå»çš„ï¼Œæˆ‘å°è¯•äº†å„ç§æ–¹å¼éƒ½æ²¡èƒ½è§£å†³æ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç®€å•çœ‹ä¸‹Demoæ•ˆæœå›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/coordinatorlayout_fix.gif" alt="image"></p>
<p>ä»gifå›¾å¤§è‡´å¯ä»¥çœ‹åˆ°AppBarLayoutæ»‘ä¸Šå»ä¹‹åæƒ¯æ€§æ¶ˆå¤±äº†ï¼Œtabä¸‹é¢çš„åŒºåŸŸæ˜¯ä¸èƒ½æ¥ç€æ»šåŠ¨çš„ã€‚</p>
<blockquote>
<p>è¿™ä¸ªæƒ¯æ€§æ¶ˆå¤±çš„é—®é¢˜ï¼Œæˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªä¸€ç¯‡è§£å†³æƒ¯æ€§æ¶ˆå¤±çš„æ–‡ç« å¦‚ä¸‹<a href="https://blog.kyleduo.com/2017/07/21/alipay-home-3-alipay-home/">æ”¯ä»˜å®é¦–é¡µäº¤äº’ä¸‰éƒ¨æ›²3å®ç°æ”¯ä»˜å®é¦–é¡µäº¤äº’</a>,å®ç°æ–¹å¼å¤§è‡´æ˜¯è‡ªå·±æŠŠCoordinatorLayoutè¿™å¥—æœºåˆ¶å†å®ç°äº†ä¸€éï¼Œå› ä¸ºæ˜¯è‡ªå·±å®ç°çš„ï¼Œé‡Œé¢çš„ä¸€äº›æœºåˆ¶æ˜¯æ¯”è¾ƒæ–¹ä¾¿æ”¹åŠ¨çš„ï¼Œå®ƒå¤„ç†æƒ¯æ€§è¿™ä¸ªé—®é¢˜çš„é€»è¾‘å¤§è‡´æ˜¯å°†AppBarLayoutä¸­æœªæ¶ˆè´¹çš„yè½´åç§»é‡æ‹¿å‡ºæ¥å†äº¤ç”±RecyclerViewå»æ»‘åŠ¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mHeaderView.setOnHeaderFlingUnConsumedListener(<span class="keyword">new</span> <span class="title class_">APHeaderView</span>.OnHeaderFlingUnConsumedListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">onFlingUnConsumed</span><span class="params">(APHeaderView header, <span class="type">int</span> targetOffset, <span class="type">int</span> unconsumed)</span> &#123;</span><br><span class="line">        APHeaderView.<span class="type">Behavior</span> <span class="variable">behavior</span> <span class="operator">=</span> mHeaderView.getBehavior();</span><br><span class="line">        <span class="type">int</span> <span class="variable">dy</span> <span class="operator">=</span> -unconsumed;</span><br><span class="line">        <span class="keyword">if</span> (behavior != <span class="literal">null</span>) &#123;</span><br><span class="line">            mRecyclerView.scrollBy(<span class="number">0</span>, dy);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œç”±äºç¯‡å¹…åŸå› ï¼Œå°±ä¸å±•å¼€è¯¦ç»†ä»‹ç»äº†ï¼Œæ„Ÿå…´è¶£åœ°åŒå­¦å¯ä»¥ç‚¹å¼€ä¸Šé¢çš„é“¾æ¥å»ç ”ç©¶ç ”ç©¶ï¼Œæ–‡ç« ä¸­ä¹Ÿè´´å‡ºäº†GitHubåœ°å€ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬é‡æ–°å›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆæƒ³æ›¿æ¢æ‰CoordinatorLayoutï¼Œå¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯CoordinatorLayoutè¿™ç§å®ç°ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ä¼šå¯¼è‡´é¡µé¢çš„åµŒå¥—å±‚çº§å¾ˆæ·±ï¼Œæˆ‘ä»¬ä»ä¸Šé¢è´´å‡ºæ¥çš„å¸ƒå±€æ¥çœ‹ï¼ŒviewåµŒå¥—çš„å±‚çº§ç‰¹åˆ«æ·±ï¼Œè€Œä¸”å¦‚æœæˆ‘ä»¬è¦å®ç°ç±»ä¼¼äº¬ä¸œæˆ–è€…æ·˜å®é¦–é¡µè¿™æ ·çš„æ•ˆæœï¼Œåœ¨TabLayoutä¸Šé¢çš„åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ç®­å¤´æ ‡æ³¨çš„åœ°æ–¹å¿…é¡»è¦é‡‡ç”¨RecyclerViewçš„æ¥å®ç°ï¼Œå› ä¸ºtabä¸ŠåŠéƒ¨åˆ†çš„å†…å®¹å’Œä¸ªæ•°éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œä½¿ç”¨RecyclerViewæ‰æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯è¿™æ ·é¡µé¢çš„å±‚çº§å°±æ›´æ·±äº†ï¼ŒåŠ è½½é€Ÿåº¦ä¹Ÿå˜å¾—æ›´æ…¢äº†ã€‚</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/CoordinatorLayout_fix.png" alt="image"></p>
<h3 id="å¦‚ä½•å®ç°"><a href="#å¦‚ä½•å®ç°" class="headerlink" title="å¦‚ä½•å®ç°"></a>å¦‚ä½•å®ç°</h3><p>è¦æŠ›å¼ƒCoordinatorLayoutï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ç”¨Android Studioä¸­çš„Layout Inspectorå·¥å…·çœ‹äº†ä¸‹äº¬ä¸œé¦–é¡µçš„å¸ƒå±€ï¼Œå‘ç°çš„ç¡®æ˜¯é‡‡ç”¨ä¸¤å±‚RecyclerViewåµŒå¥—æ¥å®ç°çš„ï¼Œå±•ç¤ºçš„å¸ƒå±€å¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/jingdong_layout.png" alt="image"></p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥æ˜¯æ€ä¹ˆå»å®ç°è¿™ä¸ªæ•ˆæœäº†ã€‚å…¶å®ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºè¦é‡‡ç”¨åµŒå¥—æ»šåŠ¨è¿™å¥—æœºåˆ¶æ¥å®ç°ï¼Œåæ¥å‘ç°ä¸é‡‡ç”¨åµŒå¥—æ»šåŠ¨æœºåˆ¶ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¤§è‡´æ„é€ è¿™æ ·ä¸€ä¸ªå¸ƒå±€ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/Images/master/nested_recycler_view.png" alt="image"></p>
<p>æˆ‘ä»¬æŠŠViewPagerä»¥åŠTabLayoutè¿™ä¸€å—ä½œä¸ºå¤–éƒ¨RecyclerViewçš„ä¸€ä¸ªitemï¼ŒViewPagerå¯èƒ½ä¼šæœ‰ä¸ªå¤šä¸ªå†…éƒ¨RecyclerViewï¼Œåªè¦æˆ‘ä»¬èƒ½è®©å¤–éƒ¨RecyclerViewå’Œå†…éƒ¨RecyclerViewçš„æ»‘åŠ¨äº‹ä»¶æ­£ç¡®åˆ†å‘åŸºæœ¬å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p>
<p>å¦‚æœåªæ˜¯æ„é€ å‡ºè¿™ä¸ªå¸ƒå±€å‡ºæ¥ï¼Œæˆ‘ä»¬å‘ç°å†…éƒ¨çš„RecyclerViewéƒ½ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå› ä¸ºæ»‘åŠ¨å®Œå…¨ç”±å¤–éƒ¨RecyclerViewæ¥ç®¡äº†ã€‚</p>
<p>é‚£ä¹ˆé‡ç‚¹æ¥äº†ï¼Œè¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†ï¼Ÿ</p>
<p>å…¶å®RecyclerViewçš„LayoutManagerä¸­æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºåˆ¤æ–­RecyclerViewåœ¨æ°´å¹³æ–¹å‘ä¸Šå’Œç«–ç›´æ–¹å‘ä¸Šæ˜¯å¦å¯ä»¥æ»šåŠ¨çš„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public boolean canScrollHorizontally() &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public boolean canScrollVertically() &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åLayoutManageræœ‰å„ç§ä¸åŒçš„å®ç°LinearLayoutManagerï¼ŒStaggeredGridLayoutManagerç­‰</p>
<p>è¿™ä¸ªLayoutManagerä¸­çš„canScrollVerticallyå’ŒcanScrollHorizontallyåœ¨RecyclerViewçš„onInterceptTouchEventä¸­æ˜¯ä¼šæ‹¿æ¥ä½œåˆ¤æ–­ï¼Œåˆ¤æ–­å½“å‰RecyclerViewæ˜¯å¦éœ€è¦å¤„ç†æ»‘åŠ¨äº‹ä»¶çš„ã€‚</p>
<blockquote>
<p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šæˆ‘ä»¬å¤„ç†å†…å¤–ä¸¤å±‚RecyclerViewçš„æ»‘åŠ¨å†²çªé—®é¢˜ï¼Œä¸»è¦æ˜¯æƒ³è§£å†³ä¸‹é¢ä¸¤ç§åœºæ™¯ï¼šä¸€ã€æ‰‹æŒ‡ä¸Šæ»‘æ—¶ï¼Œå½“å¤–éƒ¨RecyclerViewæ»‘åŠ¨åº•éƒ¨çš„æ—¶å€™ï¼Œå†…éƒ¨çš„RecyclerViewèƒ½ç»§ç»­å»å“åº”ç”¨æˆ·çš„æ»‘åŠ¨ï¼Œå› ä¸ºå†…éƒ¨çš„RecyclerViewç†è®ºä¸Šæ˜¯å¯ä»¥æ— é™æ»šåŠ¨çš„ï¼›äºŒã€æ‰‹æŒ‡ä¸‹æ»‘æ—¶ï¼Œå½“å†…éƒ¨çš„RecyclerViewæ»‘åŠ¨åˆ°é¡¶éƒ¨çš„æ—¶å€™ï¼Œå¤–éƒ¨çš„RecyclerViewèƒ½å¤Ÿç»§ç»­å“åº”ç”¨æˆ·çš„ä¸‹æ»‘äº‹ä»¶ã€‚</p>
</blockquote>
<p>å…¶å®ä¸Šé¢å·²ç»è¯´å‡ºäº†å¦‚ä½•å¤„ç†åµŒå¥—RecyclerViewçš„æœ€é‡è¦çš„ç‚¹ï¼Œå…¶ä»–çš„éƒ¨åˆ†ç›¸å½“äºéƒ½æ˜¯ä¸€äº›ç»†èŠ‚çš„å¤„ç†äº†ã€‚</p>
<p>åœ¨å¤–éƒ¨RecyclerView(ä¸‹é¢æˆParentRecyclerView)ä¸­çš„é‡å†™LayoutManagerçš„canScrollVerticallyæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fun initLayoutManager() &#123;</span><br><span class="line">    val linearLayoutManager = object :LinearLayoutManager(context) &#123;</span><br><span class="line"></span><br><span class="line">        override fun canScrollVertically():Boolean &#123;</span><br><span class="line">            //æ‰¾åˆ°å½“å‰çš„childRecyclerView</span><br><span class="line">            val childRecyclerView = findNestedScrollingChildRecyclerView()</span><br><span class="line">            //åªæœ‰å½“å‰childRecyclerViewæ»‘åŠ¨åˆ°é¡¶éƒ¨æ‰è®¤ä¸ºParentRecyclerViewæ˜¯å¯ä»¥ç«–ç›´æ–¹å‘æ˜¯å¯ä»¥æ»šåŠ¨çš„</span><br><span class="line">            return childRecyclerView == null || childRecyclerView.isScrollTop()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    linearLayoutManager.orientation = LinearLayoutManager.VERTICAL</span><br><span class="line">    layoutManager = linearLayoutManager</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å†…éƒ¨RecyclerView(ä»¥ä¸‹ç§°ChildRecyclerView)ä¸­å®šä¹‰äº†isScrollTop()ï¼Œç”¨äºåˆ¤æ–­ChildRecyclerViewæ˜¯å¦æ»šåŠ¨åˆ°é¡¶éƒ¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fun isScrollTop(): Boolean &#123;</span><br><span class="line">    //RecyclerView.canScrollVertically(-1)çš„å€¼è¡¨ç¤ºæ˜¯å¦èƒ½å‘ä¸‹æ»šåŠ¨ï¼Œfalseè¡¨ç¤ºå·²ç»æ»šåŠ¨åˆ°é¡¶éƒ¨</span><br><span class="line">    return !canScrollVertically(-1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œåœ¨ParentRecyclerViewçš„onTouchEventæ–¹æ³•ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">override fun onTouchEvent(e: MotionEvent): Boolean &#123;</span><br><span class="line">        if(lastY == 0f) &#123;</span><br><span class="line">            lastY = e.y</span><br><span class="line">        &#125;</span><br><span class="line">        if(isScrollEnd()) &#123;</span><br><span class="line">            //å¦‚æœçˆ¶RecyclerViewå·²ç»æ»‘åŠ¨åˆ°åº•éƒ¨ï¼Œéœ€è¦è®©å­RecyclerViewæ»‘åŠ¨å‰©ä½™çš„è·ç¦»</span><br><span class="line">            val childRecyclerView = findNestedScrollingChildRecyclerView()</span><br><span class="line">            childRecyclerView?.run &#123;</span><br><span class="line">                val deltaY = (lastY - e.y).toInt()</span><br><span class="line">                if(deltaY != 0) &#123;</span><br><span class="line">                    scrollBy(0,deltaY)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        lastY = e.y</span><br><span class="line">        return try &#123;</span><br><span class="line">            super.onTouchEvent(e)</span><br><span class="line">        &#125; catch (e: Exception) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">            false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å…³äºæ»‘åŠ¨äº‹ä»¶ä¸»è¦ä»£ç å°±æ˜¯ä¸Šé¢è¿™äº›ï¼Œå…·ä½“å¯ä»¥å¯ä»¥çœ‹çœ‹é¡¹ç›®ä»£ç <a href="https://github.com/JasonGaoH/NestedRecyclerView">NestedRecyclerView</a>ã€‚</p>
<p>è¿˜æœ‰å…³äºRecyclerViewçš„flingéƒ¨åˆ†ï¼Œåœ¨RecyclerViewçš„onScrollStateChangedå›è°ƒä¸­ç›‘å¬yè½´çš„æ€»çš„åç§»é‡totalDyï¼Œç„¶ååœ¨RecyclerViewä¸æ»šåŠ¨çš„æ—¶å€™äº¤ç”±å†…éƒ¨æˆ–è€…å¤–éƒ¨RecyclerViewå»flingï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œå…·ä½“å¯ä»¥çœ‹é¡¹ç›®çš„ä»£ç ã€‚</p>
<p>æœ€åè´´ä¸Šé¡¹ç›®çš„è¿è¡Œgifå›¾å±•ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/NestedRecyclerView/master/gif/nested_recyclerview_1.gif" alt="image"></p>
<p><img src="https://raw.githubusercontent.com/JasonGaoH/NestedRecyclerView/master/gif/nested_recyclerview_2.gif" alt="image"></p>
<h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>å†™ä½œä¸æ˜“ï¼Œæ¬¢è¿å¤§å®¶ç‚¹èµï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿æå‡ºä¸€èµ·è®¨è®ºï¼Œæ‚¨çš„ç‚¹èµæ˜¯æˆ‘å†™ä½œçš„æœ€å¤§åŠ¨åŠ›ï¼Œæ„Ÿè°¢ï¼</p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#RecyclerView" >
    <span class="tag-code">RecyclerView</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2020/05/21/adressing-CoordinatorLayout's-animation-jitter-and-rebound-issues/">
        <span class="nav-arrow">â† </span>
        
          è§£å†³CoordinatorLayoutçš„åŠ¨ç”»æŠ–åŠ¨ä»¥åŠå›å¼¹é—®é¢˜
        
      </a>
    
    
      <a class="nav-right" href="/2020/05/21/understand-treemap-by-using-imags/">
        
          æˆ‘ç”»äº†è¿‘ç™¾å¼ å›¾æ¥ç†è§£çº¢é»‘æ ‘
        
        <span class="nav-arrow"> â†’</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- æ‰“èµ START -->
    
    <!-- æ‰“èµ END -->
    <!-- äºŒç»´ç  START -->
    
      <div class="qrcode"></div>
      <p class="notice">å…¬ä¼—å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ˜„</p>
    
    <!-- äºŒç»´ç  END -->
    
      <!-- Utterances START -->
      <div id="utterances"></div>
      <script src="https://utteranc.es/client.js"
        repo="JasonGaoH/RepoForUtterances"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async></script>    
      <!-- Utterances END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
  <!-- Catalog END -->

</main>

<script>
  (function () {
    var url = 'https://jasongaohui.top/2020/05/21/The-tab&#39;s-sticky-effect./';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', '/css/images/error_icon.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== '/css/images/error_icon.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>







    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>


    <footer class="app-footer">
  <p class="copyright">
    &copy; 2024 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    
    

    <br/>
    æœ¬ç«™ç´¯è®¡è®¿é—®é‡<span id="busuanzi_site_pv"></span>,
    æœ¬ç«™ç´¯è®¡è®¿å®¢æ•°<span id="busuanzi_site_uv"></span>
  </p>
</footer>
<script defer src="https://busuanzi.9420.ltd/js"></script>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<!-- <script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script> -->

<script>
  var hasLine = 'true';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      hljs.configure({useBR: true});
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->


<script src="/js/script.js"></script>


  </body>
</html>